<!DOCTYPE html><html><head><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta charset="utf-8"><title>应用缓冲区处理、编码和解码二进制数据 - 读书笔记</title><meta name="description" content=""><meta name="author" content=""><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1"><link rel="stylesheet" href="../assets/css/bulma.min.css"><link rel="stylesheet" href="../assets/css/app.css"><!--[if lt IE 9]>
<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]--><link rel="shortcut icon" href=""></head><body dir="ltr"><nav class="columns navbar"><div class="column logo is-3 is-offset-1"><a class="is-brand" href="../index.html">读书笔记</a></div></nav><div class="columns content"><div class="column is-2-desktop is-3-widescreen is-hidden-touch"></div><div class="column article-container is-11-tablet is-8-desktop is-6-widescreen"><div class="breadcrumb-area"><a href="../index.html" class="breadcrumb-item">Home</a><span class="breadcrumb-delimiter"> &gt; </span><a href="../node.js高级编程/index.html" class="breadcrumb-item">node.js高级编程</a><span class="breadcrumb-delimiter"> &gt; </span><a href="../node.js高级编程/3.应用缓冲区处理、编码和解码二进制数据.html" class="breadcrumb-item">应用缓冲区处理、编码和解码二进制数据</a></div><h1 class="article-title">应用缓冲区处理、编码和解码二进制数据</h1><div class="article"><blockquote><p>JavaScript善于处理字符串，不善于处理二进制数据。</p></blockquote><p>Node引入一个二进制缓冲区实现，该实现以Buffer伪类中的JavaScriptAPI形式暴露给外界。</p><p><em>Buffer</em>类占用的内存会占据一个不会被修改的永久内存地址。</p><h2 id="创建缓冲区">创建缓冲区 <a class="markdownIt-Anchor" href="#创建缓冲区">#</a></h2><pre class="hljs"><code><span class="hljs-keyword">var</span> buf1 = <span class="hljs-keyword">new</span> Buffer(<span class="hljs-string">'hello newman!'</span>);

<span class="hljs-keyword">var</span> buf2 = <span class="hljs-keyword">new</span> Buffer(<span class="hljs-string">'8b76fde713ce'</span>,<span class="hljs-string">'base64'</span>)
</code></pre><p>可接受的编码格式：</p><ul><li><p>ASCII</p></li><li><p>UTF-8</p></li><li><p>Base64</p></li></ul><p>没有具体内容初始化，也可通过指定容量大小来创建缓冲区。</p><pre class="hljs"><code><span class="hljs-keyword">var</span> buf3 = <span class="hljs-keyword">new</span> Buffer(<span class="hljs-number">1024</span>);
</code></pre><h2 id="在缓冲区获取和设置数据">在缓冲区获取和设置数据 <a class="markdownIt-Anchor" href="#在缓冲区获取和设置数据">#</a></h2><p>使用[]操作符访问缓冲区某个字段。<strong>当被创建一个已被初始化的缓冲区时，缓冲区中包含的是一些随机值</strong></p><h2 id="切分缓冲区">切分缓冲区 <a class="markdownIt-Anchor" href="#切分缓冲区">#</a></h2><pre class="hljs"><code><span class="hljs-keyword">var</span> buf = <span class="hljs-keyword">new</span> Buffer(<span class="hljs-string">"hello newman"</span>)

<span class="hljs-keyword">var</span> newbuf = buf.slice(<span class="hljs-number">5</span>)
<span class="hljs-built_in">console</span>.log(newbuf.toString());<span class="hljs-comment">//-&gt;"newman"</span>
</code></pre><p>切分缓冲区并没用分配新的内存，也没有复制，新缓冲区使用的是父缓冲区的内存区域。</p><h2 id="复制缓冲区">复制缓冲区 <a class="markdownIt-Anchor" href="#复制缓冲区">#</a></h2><p>使用copy方法。</p><pre class="hljs"><code><span class="hljs-keyword">var</span> bufA = <span class="hljs-keyword">new</span> Buffer(<span class="hljs-string">'this is my reading note ！'</span>)
<span class="hljs-keyword">var</span> bufB = <span class="hljs-keyword">new</span> Buffer(<span class="hljs-number">12</span>)

<span class="hljs-keyword">var</span> bufAStart = <span class="hljs-number">0</span>;
<span class="hljs-keyword">var</span> bufBStart = <span class="hljs-number">11</span>;
<span class="hljs-keyword">var</span> bufBEnd = <span class="hljs-number">23</span>;

bufA.copy(bufB,bufAStart,bufBStart,bufBEnd);

<span class="hljs-built_in">console</span>.log(bufB.toString())<span class="hljs-comment">//-&gt;"reading notes"</span>
</code></pre><h2 id="缓冲区解码">缓冲区解码 <a class="markdownIt-Anchor" href="#缓冲区解码">#</a></h2><pre class="hljs"><code><span class="hljs-keyword">var</span> str = buf.toString()
</code></pre></div><div dir="ltr" class="level article-bar is-mobile"><div class="level-item has-text-centered"><a title="previous page" class="previouse-article-link" href="../node.js高级编程/2.Node核心API基础.html"><span class="icon icon-previous" data-icon="previous"></span><span class="link-content">&laquo; Previous</span></a></div><div class="level-item has-text-centered"><a title="font size" class="link-item link-item-size"><span class="icon icon-size" data-icon="size"></span></a></div><div class="level-item has-text-centered"><a title="table of content" class="link-item link-item-toc"><span class="icon icon-toc" data-icon="toc"></span></a></div><div class="level-item has-text-centered"><a title="top" href="#"><span class="icon icon-up" data-icon="up"></span> <span class="link-content">⤊ Top</span></a></div><div class="level-item has-text-centered"><a title="next page" class="next-article-link" href="../node.js高级编程/4.使用事件发射器简化事件绑定.html"><span class="icon icon-next" data-icon="next"></span><span class="link-content">Next &raquo;</span></a></div></div></div><div class="column is-2-widescreen is-hidden"></div></div><div class="columns foot"><div class="column is-3 is-offset-9 build-by">Build by <a href="https://github.com/ruanyf/loppo" target="_blank">Loppo</a> 0.6.14</div></div><div class="book-toc notification is-warning is-hidden"><h3>Table of chapters &nbsp;<span class="title-close"><a class="button is-danger"> Close</a></span></h3><ul class="chapter-area"><li class="chapter-item"><a href="../node.js高级编程/index.html">node.js高级编程</a>&nbsp;<a class="first-level-collapse"><span class="icon icon-collapse" data-icon="collapse"></span></a></li><ul class="chapter-level-1 chapter-level-1-current"><li class="chapter-item"><a href="../node.js高级编程/1.Node简介.html">Node简介</a></li><li class="chapter-item"><a href="../node.js高级编程/2.Node核心API基础.html">Node核心API基础</a></li><li class="chapter-item chapter-item-current"><a href="../node.js高级编程/3.应用缓冲区处理、编码和解码二进制数据.html">应用缓冲区处理、编码和解码二进制数据</a></li><li class="chapter-item"><a href="../node.js高级编程/4.使用事件发射器简化事件绑定.html">使用事件发射器简化事件绑定</a></li><li class="chapter-item"><a href="../node.js高级编程/note5.html">查询和读写文件</a></li></ul><li class="chapter-item"><a href="../你不知道的JavaScript/index.html">你不知道的JavaScript</a>&nbsp;<a class="first-level-collapse"><span class="icon icon-expand" data-icon="expand"></span></a></li><ul class="chapter-level-1"><li class="chapter-item"><a href="../你不知道的JavaScript/1.作用域和闭包.html">作用域和闭包</a></li><li class="chapter-item"><a href="../你不知道的JavaScript/2.词法作用域.html">词法作用域</a></li><li class="chapter-item"><a href="../你不知道的JavaScript/3.函数作用域和块作用域.html">函数作用域和块作用域</a></li><li class="chapter-item"><a href="../你不知道的JavaScript/4.提升.html">提升</a></li><li class="chapter-item"><a href="../你不知道的JavaScript/5.作用域闭包.html">作用域闭包</a></li><li class="chapter-item"><a href="../你不知道的JavaScript/6.作用域补充.html">作用域补充</a></li><li class="chapter-item"><a href="../你不知道的JavaScript/7.关于this.html">关于this</a></li><li class="chapter-item"><a href="../你不知道的JavaScript/8.this全面解析.html">this全面解析</a></li><li class="chapter-item"><a href="../你不知道的JavaScript/9.对象.html">对象</a></li></ul></ul></div><div class="progress-indicator"></div><!-- SCRIPTS --><script>var LOPPO={current_path:"node.js高级编程/3.应用缓冲区处理、编码和解码二进制数据.md",relative_root_path:"../",article_toc:'<ul class="markdownIt-TOC">\n<li><a href="#%E5%88%9B%E5%BB%BA%E7%BC%93%E5%86%B2%E5%8C%BA">创建缓冲区</a></li>\n<li><a href="#%E5%9C%A8%E7%BC%93%E5%86%B2%E5%8C%BA%E8%8E%B7%E5%8F%96%E5%92%8C%E8%AE%BE%E7%BD%AE%E6%95%B0%E6%8D%AE">在缓冲区获取和设置数据</a></li>\n<li><a href="#%E5%88%87%E5%88%86%E7%BC%93%E5%86%B2%E5%8C%BA">切分缓冲区</a></li>\n<li><a href="#%E5%A4%8D%E5%88%B6%E7%BC%93%E5%86%B2%E5%8C%BA">复制缓冲区</a></li>\n<li><a href="#%E7%BC%93%E5%86%B2%E5%8C%BA%E8%A7%A3%E7%A0%81">缓冲区解码</a></li>\n</ul>\n'}</script><script src="../assets/js/app.js"></script></body></html>
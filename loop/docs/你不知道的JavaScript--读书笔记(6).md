# 你不知道的JavaScript

## 动态作用域

> 词法作用域是一套关于引擎如何寻找变量以及会在何处找到变量的规则。词法作用域最重要的特征是它的定义过程发生在代码的书写阶段（假设你没有使用eval()或with）

动态作用域并不关心函数和作用域是如何声明以及在何处声明的，只关心它们从何处调用。作用域链是基于调用栈的，而不是代码中的作用域嵌套。

主要区别：词法作用域是在写代码或者说定义时确定的，而动态作用域是在运行时确定的。（this 也是！）词法作用域关注函数在何处声明，而动态作用域关注函数从何处调用。

```javascript
function foo() {
    console.log( a ); // 2
}
function bar() {
    var a = 3;
    foo();
}
var a = 2;
bar();

显然javascript不具有动态作用域，这里是词法作用域让foo()中的a头脑发福哦RHS引用到了全局作用域中的a。因此会输出2
```

## 块作用域替代方案

+ with

+ catch分句

+ ES6引入let

```javascript
let (a = 2) {
console.log( a ); // 2
}
console.log( a ); // ReferenceError
```

同隐式地劫持一个已经存在的作用域不同，let声明会创建一个显式的欧用于并与其进行绑定。